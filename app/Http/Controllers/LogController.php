<?php

namespace App\Http\Controllers;

use Illuminate\Http\Request;
use Illuminate\Support\Facades\File;
use Illuminate\Support\Facades\Storage;

class LogController extends Controller
{
    /*
    |---------------------------------------------------------------------------------------|
    |Protected
    |---------------------------------------------------------------------------------------|
    */
    protected $log;
    /*
    |-----------------------------------------/ Selesai  /----------------------------------|
    */




    /*
    |---------------------------------------------------------------------------------------|
    |__contruct
    |---------------------------------------------------------------------------------------|
    */
    public function __construct()
    {
        $this->log = 'siakad.log';
    }
    /*
    |-----------------------------------------/ Selesai  /----------------------------------|
    */





    /*
    |---------------------------------------------------------------------------------------|
    |index
    |---------------------------------------------------------------------------------------|
    */
    public function index()
    {

        return view('pages.logs', [
            'page' => 'Aktivitas Website',
        ]);
    }
    /*
    |-----------------------------------------/ Selesai  /----------------------------------|
    */




    /*
    |---------------------------------------------------------------------------------------|
    |Get Log
    |---------------------------------------------------------------------------------------|
    */
    public function get_logs()
    {
        if (File::exists(public_path($this->log))) {
            $logFile = File::get(public_path($this->log));
            if ($logFile !== '') {
                $log = $logFile;
            } else {
                $log = 'Nothing Logs...';
            }
        } else {
            $log = 'Nothing Logs...';
        }
        return response()->json(['log' => $log]);
    }
    /*
    |-----------------------------------------/ Selesai  /----------------------------------|
    */



    /*
    |---------------------------------------------------------------------------------------|
    |Download Log
    |---------------------------------------------------------------------------------------|
    */
    public function download_logs()
    {
        if (File::exists(public_path($this->log))) {
            return response()->download(public_path($this->log));
        } else {
            return redirect()->back()->with([
                'msg' => 'Log Tidak Ada.',
                'type' => 'error',
            ]);
        }
    }
    /*
    |-----------------------------------------/ Selesai  /----------------------------------|
    */
}
